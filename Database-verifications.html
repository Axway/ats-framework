<!doctype html>
<html>
 <head> 
  <title>ATS : Database verifications</title> 
  <link rel="stylesheet" href="styles/site.css" type="text/css"> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
 </head> 
 <body class="theme-default aui-theme-default"> 
  <div id="page"> 
   <div id="main" class="aui-page-panel"> 
    <div id="main-header"> 
     <a><img class="axway_logo" src="images/AxwayLogo.png" alt="Axway Inc"></a> 
     <div id="breadcrumb-section"> 
      <ol id="breadcrumbs"> 
       <li class="first"> <span><a href="index.html">ATS</a></span> </li> 
       <li> <span><a href="ATS-Documentation.html">ATS Documentation</a></span> </li> 
       <li> <span><a href="ATS-Guide.html">ATS Guide</a></span> </li> 
       <li> <span><a href="Basic-functionalities.html">Basic functionalities</a></span> </li> 
       <li> <span><a href="Common-test-verifications.html">Common test verifications</a></span> </li> 
      </ol> 
     </div> 
     <h1 id="title-heading" class="pagetitle"> <span id="title-text"> ATS : Database verifications </span> </h1> 
    </div> 
    <div id="content" class="view"> 
     <div id="main-content" class="wiki-content group"> 
      <h1 id="Databaseverifications-Introduction">Introduction</h1> 
      <p>Currently ATS database operations are possible for ATS supports <em>Oracle</em>, <em>MySQL</em>, <em>MSSQL</em>,&nbsp;<em>Cassandra and PostgreSQL</em></p> 
      <p>This page shows how to verify some data is present or not into some table cell following the logic of Rule Based Verifications</p> 
      <p><br></p> 
      <div class="confluence-information-macro confluence-information-macro-information"> 
       <p class="title">PostgreSQL notes</p> 
       <span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span> 
       <div class="confluence-information-macro-body"> 
        <p>When you are verifying a value from a PostgreSQL database:</p> 
        <ol> 
         <li>The format of the column name must be &lt;TABLE_NAME&gt;.&lt;COLUMN_NAME&gt;</li> 
         <li>If the table name or the column name is not lower-case only, they must be enclosed in double quotes.</li> 
        </ol> 
        <p>Example:</p> 
        <p>...</p> 
        <pre>dbVerification.checkFieldValueContains( "\"Table1\"", "Table1.column1", "How old" ); // only then using PostgreSQL</pre> 
        <pre>dbVerification.checkFieldValueContains( "Table1", "column1", "How old" ); // when using MySql, Oracle, etc</pre> 
        <p>...</p> 
       </div> 
      </div> 
      <p><br></p> 
      <p>&nbsp;</p> 
      <hr> 
      <h1 id="Databaseverifications-Constructingtheverificationobject">Constructing the verification object</h1> 
      <p>In order to create the verification object you need to pass the DB connection parameters and the table to work with.</p> 
      <p>You can do it this way:</p> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">import com.axway.ats.rbv.clients.DbVerification;
 
TestBox serverBox = new TestBox();
serverBox.setHost( SERVER_IP );
serverBox.setDbType( "ORACLE" );
serverBox.setDbName( DATABASE_NAME );
serverBox.setDbUser( USER_NAME );
serverBox.setDbPass( USER_PASSWORD );

DbVerification dbVerification = new DbVerification( serverBox, "Table1" );
</pre> 
       </div> 
      </div> 
      <p>which will actually run "<em>SELECT * FROM Table1</em>".</p> 
      <p>Or you can do it this way:</p> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">DbVerification dbVerification = new DbVerification( serverBox, new DbSearchTerm( "SELECT * FROM Table1 WHERE id = 1" ) );
</pre> 
       </div> 
      </div> 
      <p>In this case you can use some complex <em>SELECT</em> query. As you see you can add a WHERE clause or you could make joins between tables.</p> 
      <p>The next step is to define what you expect to find in the returned result set.</p> 
      <p>&nbsp;</p> 
      <hr> 
      <h1 id="Databaseverifications-Addverificationrules">Add verification rules</h1> 
      <p>Using the different<em> </em> <strong> <em>check</em>...</strong> methods you can add as many checks as you need</p> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">dbVerification.checkFieldValueContains( "Table1", "column1", "How old" );

dbVerification.checkFieldValueRegex( "Table1", "column1", ".*are you.*" );

dbVerification.checkFieldValueEquals( "Table1", "column2", "20" );
</pre> 
       </div> 
      </div> 
      <div class="confluence-information-macro has-no-icon confluence-information-macro-note"> 
       <div class="confluence-information-macro-body"> 
        <div class="confluence-information-macro has-no-icon confluence-information-macro-note conf-macro output-block"> 
         <div class="confluence-information-macro-body"> 
          <p>So far we have just specified the data we are interested in.</p> 
          <p>But the actual verification starts at the moment you call one of the <strong> <em>verify...</em> </strong> methods</p> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="confluence-information-macro has-no-icon confluence-information-macro-note"> 
       <div class="confluence-information-macro-body"> 
        <p>The list of supported methods is grows from time to time. Look up the code or javadoc for the whole list.</p> 
       </div> 
      </div> 
      <p>&nbsp;</p> 
      <hr> 
      <h1 id="Databaseverifications-VerifyDBdataexists">Verify DB data exists</h1> 
      <p>Keep polling until verify the searched data <strong>is present</strong>.</p> 
      <p>Fail if the searched data is not found for all polling attempts.</p> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">dbVerification.verifyDbDataExists();
</pre> 
       </div> 
      </div> 
      <p>&nbsp;</p> 
      <hr> 
      <h1 id="Databaseverifications-VerifyDBdatadoesnotexist">Verify DB data does not exist</h1> 
      <p>Keep polling until verify the searched data <strong>is NOT present</strong>.</p> 
      <p>Fail if the searched file is present for all polling attempts.</p> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">dbVerification.verifyDbDataDoesNotExist();
</pre> 
       </div> 
      </div> 
      <p>&nbsp;</p> 
      <hr> 
      <h1 id="Databaseverifications-VerifyDBdataalwaysexists">Verify DB data always exists</h1> 
      <p>The next code will succeed if the searched data<strong> is present for all polling attempts</strong>, otherwise it will fail.</p> 
      <p>&nbsp;</p> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">dbVerification.verifyDbDataAlwaysExists();
</pre> 
       </div> 
      </div> 
      <p>&nbsp;</p> 
      <hr> 
      <h1 id="Databaseverifications-VerifyDBdataneverexists">Verify DB data never exists</h1> 
      <p>The next code will succeed if the searched data <strong>is NOT present for all polling attempts</strong>, otherwise it will fail.</p> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">dbVerification.verifyDbDataNeverExists();
</pre> 
       </div> 
      </div> 
      <p>&nbsp;</p> 
      <hr> 
      <p>Back to <a href="Common-test-verifications.html">parent page</a><p>Go to <a href="./toc.html">Table of Contents</a></p></p> 
      <hr> 
     </div> 
    </div> 
   </div> 
  </div>   
 </body>
</html>
<!doctype html>
<html>
 <head> 
  <title>ATS : File transfers</title> 
  <link rel="stylesheet" href="styles/site.css" type="text/css"> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
 </head> 
 <body class="theme-default aui-theme-default"> 
  <div id="page"> 
   <div id="main" class="aui-page-panel"> 
    <div id="main-header"> 
     <a><img class="axway_logo" src="images/AxwayLogo.png" alt="Axway Inc"></a> 
     <div id="breadcrumb-section"> 
      <ol id="breadcrumbs"> 
       <li class="first"> <span><a href="index.html">ATS</a></span> </li> 
       <li> <span><a href="ATS-Documentation.html">ATS Documentation</a></span> </li> 
       <li> <span><a href="ATS-Guide.html">ATS Guide</a></span> </li> 
       <li> <span><a href="Basic-functionalities.html">Basic functionalities</a></span> </li> 
      </ol> 
     </div> 
     <h1 id="title-heading" class="pagetitle"> <span id="title-text"> ATS : File transfers </span> </h1> 
    </div> 
    <div id="content" class="view"> 
     <div id="main-content" class="wiki-content group"> 
      <h1 id="Filetransfers-Introduction">Introduction</h1> 
      <p>This page shows how to do simple uploads and downloads over different standard protocols.</p> 
      <p>Following are examples for all supported protocols</p> 
      <p><br></p> 
      <hr> 
      <h1 id="Filetransfers-Provideparametersspecificforsomeprotocol">Provide parameters specific for some protocol</h1> 
      <p>Each protocol sometimes needs more configuration options besides the regular host, port and user credentials.</p> 
      <p>For such cases the <strong> <em>FileTransferClient</em> </strong> provides the <em> <strong>addCustomProperty</strong> </em> method which accepts a key and value.</p> 
      <p>The key always starts with the name of the protocol - for example <em>FTPS_CONNNECTION_TYPE</em>. The possible values start with the name of the key - for example <em>FTPS_CONNNECTION_TYPE__IMPLICIT</em>, <em>FTPS_CONNNECTION_TYPE__AUTH_SSL</em> and <em>FTPS_CONNNECTION_TYPE__AUTH_TLS</em>. Using this key you can change the connection type.</p> 
      <p><br></p> 
      <hr> 
      <h1 id="Filetransfers-Connectusingmulti-factorauthentication(byusername-passwordandprivate-publickey)">Connect using multi-factor authentication (by username-password and private-public key)</h1> 
      <p>All of the available secure connection (<strong>HTTPS, FTPS, SFTP</strong>) can be created via multi-factor authentication (by providing private-public key pair, along with username and password)</p> 
      <p>The key pair can be obtained from either&nbsp;<strong>JKS (.jks) or PKCS12 (.p12)</strong>&nbsp;key stores.</p> 
      <p>The method for providing key store is <strong><em>setKeystore</em>&nbsp;</strong>and the methods providing trust store/certificate are <em><strong>setTruststore</strong></em> and <em><strong>setTrustServerSSLCertificate</strong></em>.</p> 
      <div class="confluence-information-macro has-no-icon confluence-information-macro-note"> 
       <div class="confluence-information-macro-body"> 
        <p>Specifying key store and or trusted certificates are not allowed for FTP and HTTP connections, since they are not secured and any call to such methods will result in an exception.</p> 
       </div> 
      </div> 
      <p><br></p> 
      <hr> 
      <p><br></p> 
      <h1 id="Filetransfers-Providetruststoreortrustedservercertificate">Provide trust store or trusted server certificate</h1> 
      <p>Optionally, the client can set trust server certificate/s, which will validate if the remote host is trusted or not.</p> 
      <p>The trust store can be obtained from either&nbsp;<strong>JKS (.jks) or PKCS12 (.p12)</strong>&nbsp;key stores, while the trust certificate can be obtained from a&nbsp;<strong>PEM (.pem) file</strong>.</p> 
      <p><br></p> 
      <div class="confluence-information-macro has-no-icon confluence-information-macro-note"> 
       <div class="confluence-information-macro-body"> 
        <p>If you specify trust store and than trust certificate, only the trust certificate will be used for validation and if the order is reversed, then the trust store will be used.</p> 
       </div> 
      </div> 
      <hr> 
      <h1 id="Filetransfers-FTP/FTPSclient"><span style="color: rgb(120,0,0);">FTP/FTPS client</span></h1> 
      <p><br></p> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">import com.axway.ats.action.filetransfer.FileTransferClient;

// Instantiate the File Transfer client by providing the protocol to use
FileTransferClient transferClient = new FileTransferClient( TransferProtocol.FTPS );
// set a custom port(if not using the default one)
transferClient.setPort( 121 );

// the next method can be used to set some custom properties, for example to set the FTP connection type
transferClient.addCustomProperty( FileTransferClient.FTPS_CONNNECTION_TYPE, FileTransferClient.FTPS_CONNNECTION_TYPE__IMPLICIT);


// set key-pair (e.g. enable multi-factor authentication)
// note that the last argument is required only when working with SFTP connections
transferClient.setKeystore( KEY_STORE_LOCATION, KEY_STORE_PASSWORD, KEY_ALIAS );


// specify trusted server certificates (this step is optional)
// provide trust store
transferClient.setTruststore( TRUST_STORE_LOCATION, TRUST_STORE_PASSWORD );
// or provide PEM certificate
transferClient.setTrustedServerSSLCertificate( TRUSTED_SERVER_CERTIFICATE );
 
// connect using appropriate parameters
transferClient.connect( SERVER_IP, USER_NAME, USER_PASSWORD );
 
// upload a local file to the remote root folder of our user
transferClient.uploadFile( LOCAL_FILE_LOCATION + FILE_NAME, "/" );
 
// disconnect the File Transfer client
transferClient.disconnect();
</pre> 
       </div> 
      </div> 
      <div class="confluence-information-macro has-no-icon confluence-information-macro-note"> 
       <div class="confluence-information-macro-body"> 
        <p>In order to use FTP you need to provide TransferProtocol.FTP argument in the FileTransferClient constructor</p> 
       </div> 
      </div> 
      <p>Here is the list of options specific for this protocol only:</p> 
      <div class="table-wrap"> 
       <table class="wrapped confluenceTable"> 
        <colgroup> 
         <col> 
         <col> 
         <col> 
        </colgroup> 
        <tbody> 
         <tr> 
          <th class="confluenceTh"><p>custom properties for FTPS</p></th> 
          <th class="confluenceTh"><p>accepted value</p></th> 
          <th class="confluenceTh"><p>default value</p></th> 
         </tr> 
         <tr> 
          <td class="confluenceTd"><p>FTPS_CONNNECTION_TYPE</p></td> 
          <td class="confluenceTd"><p>FTPS_CONNNECTION_TYPE__IMPLICIT <br class="atl-forced-newline">FTPS_CONNNECTION_TYPE__AUTH_SSL <br class="atl-forced-newline">FTPS_CONNNECTION_TYPE__AUTH_TLS</p></td> 
          <td class="confluenceTd"><p>FTPS_CONNNECTION_TYPE__IMPLICIT</p></td> 
         </tr> 
         <tr> 
          <td class="confluenceTd"><p>FTPS_ENCRYPTION_PROTOCOLS</p></td> 
          <td class="confluenceTd"><p>SSL, TLSv1.2</p></td> 
          <td class="confluenceTd"><p>TLSv1.2</p></td> 
         </tr> 
        </tbody> 
       </table> 
      </div> 
      <p><br></p> 
      <hr> 
      <h3 id="Filetransfers-RunninganyFTPcommand">Running any FTP command</h3> 
      <p>This is rarely used, but it is possible to run any FTP/FTPS command with code like the following</p> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">// execute some FTP command
ftpClient.executeCommand( "mdir some_remote_directory" );

// execute some FTP command ...
String commandReturnCode = ftpClient.executeCommand( "mdir some_remote_directory" );
// and analyze the return code as needed
</pre> 
       </div> 
      </div> 
      <p>Of course you still need to take care of connecting and disconnecting as the other examples show.</p> 
      <div class="confluence-information-macro confluence-information-macro-note"> 
       <span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span> 
       <div class="confluence-information-macro-body"> 
        <p>It is important to know that the list of supported commands is specific to the remote FTP server</p> 
       </div> 
      </div> 
      <p><br></p> 
      <hr> 
      <h1 id="Filetransfers-HTTP/HTTPSclient">HTTP/HTTPS client</h1> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">FileTransferClient httpClient = new FileTransferClient( TransferProtocol.HTTP );

// example how to set custom property supported for HTTP or HTTPS transfers
httpClient.addCustomProperty( FileTransferClient.HTTP_HTTPS_UPLOAD_CONTENT_TYPE, "text/plain");
httpClient.addCustomProperty( FileTransferClient.HTTP_HTTPS_SOCKET_READ_TIMEOUT, "10000");


// set key-pair (e.g. enable multi-factor authentication)
// note that the last argument is required only when working with SFTP connections
httpClient.setKeystore( KEY_STORE_LOCATION, KEY_STORE_PASSWORD, KEY_ALIAS );

// specify trusted server certificates (this step is optional)
// provide trust store
httpClient.setTruststore( TRUST_STORE_LOCATION, TRUST_STORE_PASSWORD );
// or provide PEM certificate
httpClient.setTrustedServerSSLCertificate( TRUSTED_SERVER_CERTIFICATE );

// do something real
httpClient.connect( SERVER_IP, USER_NAME, USER_PASSWORD );

// upload a local file to the remote root folder of our user
httpClient.uploadFile( LOCAL_FILE_LOCATION + FILE_NAME, "/" );

httpClient.disconnect();
</pre> 
       </div> 
      </div> 
      <div class="confluence-information-macro has-no-icon confluence-information-macro-note"> 
       <div class="confluence-information-macro-body"> 
        <p>In order to use FTP you need to provide TransferProtocol.FTP argument in the FileTransferClient constructor</p> 
       </div> 
      </div> 
      <p><br></p> 
      <p>Here is the list of options specific for this protocol only:</p> 
      <div class="table-wrap"> 
       <table class="wrapped confluenceTable"> 
        <colgroup> 
         <col> 
         <col> 
         <col> 
         <col> 
        </colgroup> 
        <tbody> 
         <tr> 
          <th class="confluenceTh"><p>custom properties for HTTP/HTTPS</p></th> 
          <th class="confluenceTh"><p>accepted value</p></th> 
          <th class="confluenceTh"><p>default value</p></th> 
          <th class="confluenceTh"><p>description</p></th> 
         </tr> 
         <tr> 
          <td class="confluenceTd"><p>HTTP_HTTPS_SOCKET_BUFFER_SIZE</p></td> 
          <td class="confluenceTd"><p>number of bytes</p></td> 
          <td class="confluenceTd"><p>8196</p></td> 
          <td class="confluenceTd"><br></td> 
         </tr> 
         <tr> 
          <td class="confluenceTd"><p>HTTP_HTTPS_UPLOAD_METHOD</p></td> 
          <td class="confluenceTd"><p>HTTP_HTTPS_UPLOAD_METHOD__PUT <br class="atl-forced-newline">HTTP_HTTPS_UPLOAD_METHOD__POST</p></td> 
          <td class="confluenceTd"><p>HTTP_HTTPS_UPLOAD_METHOD__<br>PUT</p></td> 
          <td class="confluenceTd"><br></td> 
         </tr> 
         <tr> 
          <td class="confluenceTd"><p>HTTP_HTTPS_<br>PREEMPTIVE_BASIC_AUTHENTICATION</p></td> 
          <td class="confluenceTd"><p>HTTP_HTTPS_<br>PREEMPTIVE_BASIC_AUTHENTICATION__<br>TRUE</p></td> 
          <td class="confluenceTd"><p>not used by default</p></td> 
          <td class="confluenceTd"><p>By default when username and user password are provided for HTTP Basic Authentication, these credentials are not sent with the first request. The server replies back requesting the credentials and then they are given to the server in order to authenticate. This custom property is used in case when the authentication must happen with the very first request.</p></td> 
         </tr> 
         <tr> 
          <td class="confluenceTd"><p>HTTP_HTTPS_UPLOAD_CONTENT_TYPE</p></td> 
          <td class="confluenceTd"><p>Any valid value for the content type header</p></td> 
          <td class="confluenceTd"><p>application/octet-stream</p></td> 
          <td class="confluenceTd"><br></td> 
         </tr> 
         <tr> 
          <td class="confluenceTd"><p>HTTP_HTTPS_SOCKET_READ_TIMEOUT</p></td> 
          <td class="confluenceTd"><p>Number of milliseconds for socket read timeout</p></td> 
          <td class="confluenceTd"><p>0 (wait indefinitely)</p></td> 
          <td class="confluenceTd"><p>Specify socket read timeout. This is the maximum time the client waits to read new data from server.</p></td> 
         </tr> 
         <tr> 
          <td colspan="1" class="confluenceTd"><span class="blob-code-inner blob-code-marker"><span class="pl-c1">HTTP_HTTPS_TRANSFER_ENCODING_MODE</span></span></td> 
          <td colspan="1" class="confluenceTd"><span class="blob-code-inner blob-code-marker"><span class="pl-c1">HTTP_HTTPS_TRANSFER_ENCODING_MODE__CHUNKED</span></span></td> 
          <td colspan="1" class="confluenceTd">chunked request mode not used by default</td> 
          <td colspan="1" class="confluenceTd">Specify whether the file upload will be performed in chunks (Transfer-Encoding: chunked) or in one part. <br>Currently chunk size is hardcoded in underlying library to 4096 bytes and could not be changed.</td> 
         </tr> 
        </tbody> 
       </table> 
      </div> 
      <hr> 
      <h1 id="Filetransfers-SFTPclient">SFTP client</h1> 
      <div class="code panel pdl" style="border-width: 1px;"> 
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-theme="Confluence">FileTransferClient sftpClient = new FileTransferClient( TransferProtocol.SFTP );

// set key-pair (e.g. enable multi-factor authentication)
// note that the last argument is required only when working with SFTP connections
sftpClient.setKeystore( KEY_STORE_LOCATION, KEY_STORE_PASSWORD, KEY_ALIAS );
// specify trusted server certificates (this step is optional)
// provide trust store
sftpClient.setTruststore( TRUST_STORE_LOCATION, TRUST_STORE_PASSWORD );
// or provide PEM certificate 
sftpClient.setTrustedServerSSLCertificate( TRUSTED_SERVER_CERTIFICATE );

// do something real
sftpClient.connect( SERVER_IP, USER_NAME, USER_PASSWORD );

// upload a local file to the remote root folder of our user
sftpClient.uploadFile( LOCAL_FILE_LOCATION + FILE_NAME, "/" );

sftpClient.disconnect();
</pre> 
       </div> 
      </div> 
      <p>Here is the list of options specific for this protocol only:</p> 
      <div class="table-wrap"> 
       <table class="wrapped confluenceTable"> 
        <colgroup> 
         <col> 
         <col> 
         <col> 
         <col> 
        </colgroup> 
        <tbody> 
         <tr> 
          <th class="confluenceTh">custom properties for SFTP</th> 
          <th class="confluenceTh">accepted value</th> 
          <th class="confluenceTh">default value</th> 
          <th class="confluenceTh">description</th> 
         </tr> 
         <tr> 
          <td class="confluenceTd">SFTP_USERNAME</td> 
          <td class="confluenceTd">some user name</td> 
          <td class="confluenceTd"><br></td> 
          <td class="confluenceTd"><p>Username when authenticating over SFTP.</p><p>If not specified, the public key alias name is used instead of a user name</p></td> 
         </tr> 
         <tr> 
          <td class="confluenceTd">SFTP_CIPHERS</td> 
          <td class="confluenceTd"><p>One or many(as array) constants of</p><p>com.axway.ats.common.filetransfer.SshCipher</p><p>For example AES128_CBC, BLOWFISH_CBC etc.</p></td> 
          <td class="confluenceTd"><br></td> 
          <td class="confluenceTd">A cipher suite - this could be com.axway.ats.common.filetransfer.SshCipher instance or array of such instances.</td> 
         </tr> 
        </tbody> 
       </table> 
      </div> 
      <p><br></p> 
      <hr> 
      <p>Back to <a href="Basic-functionalities.html">parent page</a><p>Go to <a href="./toc.html">Table of Contents</a></p></p> 
      <hr> 
     </div> 
    </div> 
   </div> 
  </div>  
 </body>
</html>
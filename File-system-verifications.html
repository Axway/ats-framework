<!DOCTYPE html>
<html>
    <head>
        <title>ATS : File system verifications</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">ATS</a></span>
                            </li>
                                                    <li>
                                <span><a href="ATS-OS-Documentation.html">ATS OS Documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="ATS-Guide.html">ATS Guide</a></span>
                            </li>
                                                    <li>
                                <span><a href="Basic-functionalities.html">Basic functionalities</a></span>
                            </li>
                                                    <li>
                                <span><a href="Common-test-verifications.html">Common test verifications</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            ATS : File system verifications
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Nikolay Gogovski</span>, last modified on Mar 22, 2017
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="Filesystemverifications-Introduction">Introduction</h1><p>This page shows how you can verify whether some <em>File</em> or <em>Folder</em> is present or not  at some local or remote <em>host</em></p><p> </p><hr/><h1 id="Filesystemverifications-Constructingtheverificationobject">Constructing the verification object</h1><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">import com.axway.ats.rbv.clients.FileSystemVerification;

// Make an instance of the verification object.
// The first input argument points to the remote ATS Agent, skip this argument if working on the local host
FileSystemVerification fsVerification = new FileSystemVerification( SERVER_IP, FILE_LOCATION );</pre>
</div></div><div class="confluence-information-macro has-no-icon confluence-information-macro-note"><div class="confluence-information-macro-body"><p>If you want to work locally, use the constructor which does not specify a remote host ip</p></div></div><div class="confluence-information-macro has-no-icon confluence-information-macro-note"><div class="confluence-information-macro-body"><p>When working remotely, the ATS Agent must be running on the remote host</p></div></div><p> </p><hr/><h1 id="Filesystemverifications-Addverificationrules">Add verification rules</h1><p>Using the different<em> </em> <strong> <em>check</em>...</strong> methods you can add as many checks as you need</p><p>Following is an example as complex as you will never need in practice <img class="emoticon emoticon-smile" src="images/icons/emoticons/smile.png" data-emoticon-name="smile" alt="(smile)"/></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">// check the size of the files
fsVerification.checkSize( 62 );

// the file must contain some static text
fsVerification.checkContents( &quot;line 3&quot;, false, true );

// at least one line of the file end with the number 3
// we are using a regular expression here
fsVerification.checkContents( &quot;.*3&quot;, true, true );

// verify the file MD5 sum by providing the exact sum
fsVerification.checkMd5( &quot;560bba529205da4d92bebb026b2e6e8b&quot; );

// Verify the file MD5 sum, but this time do not give the sum itself, instead we provide a sample file.
// The usual case is if you upload a local file, then you want to make sure the remote file has
// same MD5 sum as the original local file
fsVerification.checkMd5( null, LOCAL_FILE );

// verify the GID and UID
fsVerification.checkGID( 1001 );
fsVerification.checkUID( 1001 );

// verify the file permission attributes
fsVerification.checkPermissions( 644 );</pre>
</div></div><div class="confluence-information-macro has-no-icon confluence-information-macro-note"><div class="confluence-information-macro-body"><p>So far we have just specified what kind of file we are interested in.</p><p>But the actual verification starts at the moment you call one of the <strong> <em>verify...</em> </strong> methods</p></div></div><p> </p><hr/><h1 id="Filesystemverifications-Verifyafileexists">Verify a file exists</h1><p>Keep polling until verify the searched file <strong>is present</strong>.</p><p>Fail if the searched file is not found for all polling attempts.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">fsVerification.verifyFileExists();
</pre>
</div></div><p> </p><hr/><h1 id="Filesystemverifications-Successfulverificationoutput">Successful verification output</h1><p><em>RBV</em> is verbose enough so from the logs you can understand if each of these checks was successful. It takes a little time until get used with these log messages, but they look the same for all kind of checks.</p><p>For example a part of the output in this example would be:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">INFO  17:29:13 rules.FileSizeRule: Starting evaluation of rule &#39;checkSize&#39; which expects file with size &#39;62&#39;
INFO  17:29:13 rules.FileSizeRule: Processing meta data { FILE_PACKAGE : /tmp/file.txt }
INFO  17:29:13 rules.FileSizeRule: Found a match!
INFO  17:29:13 rules.FileSizeRule: Finished evaluation of rule &#39;checkSize&#39; which expects file with size &#39;62&#39;
</pre>
</div></div><p> </p><hr/><h1 id="Filesystemverifications-Unsuccessfulverificationoutput">Unsuccessful verification output</h1><p>Upon a failure, you will get output like the following:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">INFO  17:39:49 rules.FileSizeRule: Starting evaluation of rule &#39;checkSize&#39; which expects file with size &#39;602&#39;
INFO  17:39:49 rules.FileSizeRule: Processing meta data { FILE_PACKAGE : /tmp/file.txt }
INFO  17:39:49 rules.FileSizeRule: Did not find a match!
INFO  17:39:49 rules.FileSizeRule: Finished evaluation of rule &#39;checkSize&#39; which expects file with size &#39;602&#39;
</pre>
</div></div><p>Upon failure, a new try is made until all the allowed tries are exhausted and a final failure results in throwing an exception which fails the test case.</p><p> </p><hr/><h1 id="Filesystemverifications-Verifyafiledoesnotexist">Verify a file does not exist</h1><p>Keep polling until verify the searched file<strong> is NOT present</strong>.</p><p>Fail if the searched file is present for all polling attempts.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">fsVerification.verifyFileDoesNotExist();
</pre>
</div></div><p> </p><hr/><h1 id="Filesystemverifications-Verifyafilealwaysexists">Verify a file always exists</h1><p>The next code will succeed if the searched file<strong> is present for all polling attempts</strong>, otherwise it will fail.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">fsVerification.verifyFileAlwaysExists();
</pre>
</div></div><p> </p><hr/><h1 id="Filesystemverifications-Verifyafileneverexists">Verify a file never exists</h1><p>The next code will succeed if the searched file <strong>is NOT present for all polling attempts</strong>, otherwise it will fail.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">fsVerification.verifyFileNeverExist();
</pre>
</div></div><p> </p><hr/><h1 id="Filesystemverifications-Verifyafolderexists">Verify a folder exists</h1><p>Here is how you can verify the existence of a folder</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">FileSystemVerification fsVerification = new FileSystemVerification( SERVER_IP, &quot;/tmp&quot; );

// verify the GID and UID
fsVerification.checkGID( 1001 );
fsVerification.checkUID( 1001 );

// verify the folder permission attributes
fsVerification.checkPermissions( 1777 );

fsVerification.verifyFolderExists();
</pre>
</div></div><p>The logic is basically the same as with the files. But of course all those <strong> <em>check...</em> </strong> methods are not applicable to folders.</p><p> </p><hr/><h1 id="Filesystemverifications-Verifyafolderdoesnotexist">Verify a folder does not exist</h1><p>Keep polling until verify the searched folder<strong> is NOT present</strong>.</p><p>Fail if the searched folder is present for all polling attempts.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">fsVerification.verifyFolderDoesNotExist();
</pre>
</div></div><p> </p><hr/><h1 id="Filesystemverifications-Verifyafolderalwaysexists">Verify a folder always exists</h1><p>The next code will succeed if the searched folder<strong> is present for all polling attempts</strong>, otherwise it will fail.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">fsVerification.verifyFolderAlwaysExists();
</pre>
</div></div><p> </p><hr/><h1 id="Filesystemverifications-Verifyafolderneverexists">Verify a folder never exists</h1><p>The next code will succeed if the searched folder <strong>is NOT present for all polling attempts</strong>, otherwise it will fail.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">fsVerification.verifyFolderNeverExist();
</pre>
</div></div><p> </p><hr/><p>Back to <a href="Common-test-verifications.html">parent page</a></p><hr/>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Apr 05, 2017 10:53</p>
                    <div id="footer-logo"></div>
                </section>
            </div>
        </div>     </body>
</html>


